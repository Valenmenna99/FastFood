-- EXTRA CREDIT
-- Expansión de datos:
-- En tabla de ordenes
INSERT INTO ventas.orden (cliente_id , empleado_id , sucursal_id, mensajero_id, tipo_pago_id, origen_id, horario_venta, total_compra, km_recorrer, fecha_despacho, fecha_entrega, fecha_orden_tomada, fecha_orden_lista) VALUES
(10, 1, 2, 10, 4, 2, 'Tarde', 1021.34, 6.5, '2023-09-02 14:30:00', '2023-09-02 15:00:00', '2023-09-02 14:00:00', '2023-09-02 14:15:00'),
(2, 2, 3, 2, 1, 3, 'Mañana', 984.45, 9.1, '2023-09-10 08:30:00', '2023-09-10 09:00:00', '2023-09-10 08:00:00', '2023-09-10 08:15:00'),
(3, 3, 4, 3, 2, 4, 'Noche', 1057.80, 7.3, '2023-10-01 19:30:00', '2023-10-01 20:00:00', '2023-10-01 19:00:00', '2023-10-01 19:15:00'),
(9, 4, 5, 4, 3, 5, 'Tarde', 1001.25, 4.7, '2023-10-15 14:30:00', '2023-10-15 15:00:00', '2023-10-15 14:00:00', '2023-10-15 14:15:00'),
(5, 5, 1, 5, 4, 1, 'Mañana', 991.77, 10.8, '2023-10-25 08:30:00', '2023-10-25 09:00:00', '2023-10-25 08:00:00', '2023-10-25 08:15:00'),
(6, 6, 2, 6, 1, 2, 'Noche', 1068.90, 2.9, '2023-11-02 19:30:00', '2023-11-02 20:00:00', '2023-11-02 19:00:00', '2023-11-02 19:15:00'),
(7, 10, 3, 7, 2, 3, 'Mañana', 944.62, 3.3, '2023-11-10 08:30:00', '2023-11-10 09:00:00', '2023-11-10 08:00:00', '2023-11-10 08:15:00'),
(7, 8, 4, 8, 3, 4, 'Tarde', 1007.95, 7.0, '2023-11-20 14:30:00', '2023-11-20 15:00:00', '2023-11-20 14:00:00', '2023-11-20 14:15:00'),
(9, 10, 5, 9, 4, 5, 'Noche', 993.18, 6.4, '2023-12-02 19:30:00', '2023-12-02 20:00:00', '2023-12-02 19:00:00', '2023-12-02 19:15:00'),
(2, 2, 1, 2, 1, 1, 'Tarde', 1073.02, 5.2, '2023-12-10 14:30:00', '2023-12-10 15:00:00', '2023-12-10 14:00:00', '2023-12-10 14:15:00');

-- En tabla de detalle_ordenes: 
INSERT INTO ventas.detalle_orden (orden_id, producto_id, cantidad, total) VALUES
-- Orden 2 (total_compra 1075.00)
(2, 1, 3, 400.00),
(2, 4, 2, 375.00),
(2, 6, 1, 300.00),

-- Orden 3 (total_compra 920.00)
(3, 2, 5, 300.00),
(3, 5, 3, 320.00),
(3, 7, 2, 300.00),

-- Orden 4 (total_compra 930.00)
(4, 3, 4, 310.00),
(4, 8, 1, 320.00),
(4, 2, 2, 300.00),

-- Orden 5 (total_compra 955.00)
(5, 1, 2, 350.00),
(5, 4, 3, 305.00),
(5, 6, 4, 300.00),

-- Orden 6 (total_compra 945.00)
(6, 2, 6, 345.00),
(6, 5, 1, 300.00),
(6, 8, 2, 300.00),

-- Orden 7 (total_compra 1065.00)
(7, 3, 3, 400.00),
(7, 7, 5, 365.00),
(7, 8, 1, 300.00),

-- Orden 8 (total_compra 1085.00)
(8, 1, 4, 400.00),
(8, 6, 3, 385.00),
(8, 4, 2, 300.00),

-- Orden 9 (total_compra 1095.00)
(9, 2, 2, 395.00),
(9, 4, 4, 400.00),
(9, 5, 3, 300.00),

-- Orden 14 (total_compra 1021.34)
(14, 1, 2, 400.00),
(14, 3, 1, 321.34),
(14, 5, 4, 300.00),

-- Orden 15 (total_compra 984.45)
(15, 2, 3, 300.00),
(15, 4, 2, 284.45),
(15, 7, 1, 400.00),

-- Orden 16 (total_compra 1057.80)
(16, 1, 1, 350.00),
(16, 6, 2, 357.80),
(16, 8, 3, 350.00),

-- Orden 17 (total_compra 1001.25)
(17, 3, 4, 400.00),
(17, 5, 2, 301.25),
(17, 7, 1, 300.00),

-- Orden 18 (total_compra 991.77)
(18, 2, 2, 350.00),
(18, 7, 3, 341.77),
(18, 5, 1, 300.00),

-- Orden 19 (total_compra 1068.90)
(19, 1, 5, 400.00),
(19, 4, 1, 368.90),
(19, 6, 2, 300.00),

-- Orden 20 (total_compra 944.62)
(20, 3, 2, 300.00),
(20, 5, 3, 344.62),
(20, 8, 1, 300.00),

-- Orden 21 (total_compra 1007.95)
(21, 2, 4, 400.00),
(21, 7, 2, 307.95),
(21, 8, 1, 300.00),

-- Orden 22 (total_compra 993.18)
(22, 1, 1, 300.00),
(22, 4, 3, 393.18),
(22, 3, 2, 300.00),

-- Orden 23 (total_compra 1073.02)
(23, 1, 1, 300.00),
(23, 4, 3, 393.18),
(23, 3, 2, 379.84);

--Nuevas consultas estratégicas: 

-- ¿Qué categoría de producto genera mayores ingresos?
SELECT 
  c.nombre_categoria,
  SUM(d.total) AS ingresos_categoria
FROM ventas.detalle_orden AS d
JOIN productos.producto AS p ON d.producto_id = p.producto_id
JOIN productos.categoria AS c ON p.categoria_id = c.categoria_id
GROUP BY c.nombre_categoria
ORDER BY ingresos_categoria DESC;

